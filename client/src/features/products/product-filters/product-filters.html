<div class="w-72 bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden">
  <!-- Заголовок фильтров -->
  <div class="flex items-center justify-between p-4 bg-gray-50 border-b border-gray-200">
    <h3 class="m-0 text-base font-semibold text-gray-900 flex items-center gap-2">
      <span>Фильтры</span>
      @if (hasActiveFilters()) {
        <span class="w-2 h-2 bg-blue-500 rounded-full"></span>
      }
    </h3>
    <button 
      type="button" 
      class="toggle-button bg-transparent border-none cursor-pointer p-1 text-gray-500 transition-all duration-200 rounded hover:bg-gray-200 hover:text-gray-700"
      (click)="toggleExpanded()"
      [class.expanded]="isExpanded()">
      <svg width="16" height="16" viewBox="0 0 16 16">
        <path d="M4 6l4 4 4-4" stroke="currentColor" stroke-width="2" fill="none"/>
      </svg>
    </button>
  </div>

  <!-- Контент фильтров -->
  <div class="filter-content max-h-[600px]" [class.collapsed]="!isExpanded()">
    
    <!-- Поиск -->
    <div class="p-4 border-b border-gray-100">
      <label class="block text-sm font-medium text-gray-700 mb-2">Поиск</label>
      <input 
        type="text" 
        class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm transition-colors duration-200 
               focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100"
        placeholder="Поиск по названию или артикулу..."
        [value]="searchQuery()"
        (input)="onSearchInput($event)">
    </div>

    <!-- Категории -->
    <div class="p-4 border-b border-gray-100">
      <label class="block text-sm font-medium text-gray-700 mb-2">Категории</label>
      @if (isLoading()) {
        <div class="text-center text-gray-500 text-sm py-3">Загрузка...</div>
      } @else {
        <div class="category-list overflow-y-auto">
          @for (category of availableCategories(); track category) {
            <label class="flex items-center gap-2 py-1.5 cursor-pointer transition-colors duration-200 rounded hover:bg-gray-50">
              <input 
                type="checkbox" 
                class="m-0 accent-blue-500"
                [checked]="isCategorySelected(category)"
                (change)="onCategoryChange(category, $event.target.checked)">
              <span class="text-sm text-gray-700 flex-1">{{ category }}</span>
            </label>
          }
          @if (availableCategories().length === 0) {
            <div class="text-center text-gray-400 text-sm py-3">Категории не найдены</div>
          }
        </div>
      }
    </div>

    <!-- Диапазон цен -->
    <div class="p-4 border-b border-gray-100">
      <label class="block text-sm font-medium text-gray-700 mb-2">Цена (₽)</label>
      <div class="flex items-center gap-2">
        <input 
          type="number" 
          class="flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm transition-colors duration-200 
                 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100"
          placeholder="От"
          [value]="priceRange().min || ''"
          (input)="updatePriceRange('min', $event)">
        <span class="text-gray-500 font-medium">—</span>
        <input 
          type="number" 
          class="flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm transition-colors duration-200 
                 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100"
          placeholder="До"
          [value]="priceRange().max || ''"
          (input)="updatePriceRange('max', $event)">
      </div>
    </div>

    <!-- Сортировка -->
    <div class="p-4 border-b border-gray-100">
      <label class="block text-sm font-medium text-gray-700 mb-2">Сортировка</label>
      <div class="flex gap-2">
        <select 
          class="flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm bg-white transition-colors duration-200 
                 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100"
          [value]="sortBy()"
          (change)="updateSortBy($event)">
          <option value="name">По названию</option>
          <option value="category">По категории</option>
          <option value="article">По артикулу</option>
        </select>
        <button 
          type="button"
          class="px-3 py-2 border border-gray-300 rounded-md bg-white cursor-pointer transition-all duration-200 
                 flex items-center justify-center hover:bg-gray-50 hover:border-gray-400"
          [class.bg-blue-50]="sortOrder() === 'desc'"
          [class.border-blue-500]="sortOrder() === 'desc'"
          [class.text-blue-500]="sortOrder() === 'desc'"
          (click)="toggleSortOrder()">
          <svg width="16" height="16" viewBox="0 0 16 16">
            @if (sortOrder() === 'asc') {
              <path d="M8 2l4 6H4l4-6z" fill="currentColor"/>
            } @else {
              <path d="M8 14l4-6H4l4 6z" fill="currentColor"/>
            }
          </svg>
        </button>
      </div>
    </div>

    <!-- Кнопка очистки -->
    @if (hasActiveFilters()) {
      <div class="p-4">
        <button 
          type="button" 
          class="w-full px-4 py-2 bg-gray-100 border border-gray-300 rounded-md text-gray-700 text-sm 
                 cursor-pointer transition-all duration-200 hover:bg-gray-200 hover:border-gray-400"
          (click)="clearFilters()">
          Очистить фильтры
        </button>
      </div>
    }
  </div>
</div>